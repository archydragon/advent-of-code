-module(d14).
-export([run/0]).

run() ->
    Input = [
        [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{545,125}, {549,125}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{500,34}, {500,37}, {496,37}, {496,40}, {506,40}, {506,37}, {504,37}, {504,34}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{539,150}, {539,152}, {534,152}, {534,159}, {544,159}, {544,152}, {543,152}, {543,150}], [{500,34}, {500,37}, {496,37}, {496,40}, {506,40}, {506,37}, {504,37}, {504,34}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{558,119}, {563,119}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{539,131}, {543,131}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{526,82}, {530,82}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{548,122}, {553,122}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{500,34}, {500,37}, {496,37}, {496,40}, {506,40}, {506,37}, {504,37}, {504,34}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{523,84}, {527,84}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{551,119}, {556,119}], [{529,84}, {533,84}], [{505,62}, {509,62}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{526,86}, {530,86}], [{548,128}, {552,128}], [{500,34}, {500,37}, {496,37}, {496,40}, {506,40}, {506,37}, {504,37}, {504,34}], [{504,19}, {504,23}, {503,23}, {503,31}, {512,31}, {512,23}, {507,23}, {507,19}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{523,88}, {527,88}], [{551,131}, {555,131}], [{541,122}, {546,122}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{517,88}, {521,88}], [{504,19}, {504,23}, {503,23}, {503,31}, {512,31}, {512,23}, {507,23}, {507,19}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{562,122}, {567,122}], [{539,150}, {539,152}, {534,152}, {534,159}, {544,159}, {544,152}, {543,152}, {543,150}], [{532,82}, {536,82}], [{505,58}, {509,58}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{502,60}, {506,60}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{535,88}, {539,88}], [{554,134}, {558,134}], [{539,150}, {539,152}, {534,152}, {534,159}, {544,159}, {544,152}, {543,152}, {543,150}], [{500,34}, {500,37}, {496,37}, {496,40}, {506,40}, {506,37}, {504,37}, {504,34}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{508,56}, {512,56}], [{540,91}, {540,92}, {547,92}, {547,91}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{540,91}, {540,92}, {547,92}, {547,91}], [{521,65}, {521,67}, {513,67}, {513,72}, {526,72}, {526,67}, {523,67}, {523,65}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{499,62}, {503,62}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{548,134}, {552,134}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{542,134}, {546,134}], [{518,76}, {518,77}, {530,77}, {530,76}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{544,119}, {549,119}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{493,15}, {493,16}, {504,16}, {504,15}],
        [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{542,128}, {546,128}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{540,91}, {540,92}, {547,92}, {547,91}], [{511,58}, {515,58}], [{500,34}, {500,37}, {496,37}, {496,40}, {506,40}, {506,37}, {504,37}, {504,34}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{538,86}, {542,86}], [{521,65}, {521,67}, {513,67}, {513,72}, {526,72}, {526,67}, {523,67}, {523,65}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{504,19}, {504,23}, {503,23}, {503,31}, {512,31}, {512,23}, {507,23}, {507,19}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{508,60}, {512,60}], [{517,62}, {521,62}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{518,76}, {518,77}, {530,77}, {530,76}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{493,15}, {493,16}, {504,16}, {504,15}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{521,65}, {521,67}, {513,67}, {513,72}, {526,72}, {526,67}, {523,67}, {523,65}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{547,116}, {552,116}], [{504,19}, {504,23}, {503,23}, {503,31}, {512,31}, {512,23}, {507,23}, {507,19}], [{539,150}, {539,152}, {534,152}, {534,159}, {544,159}, {544,152}, {543,152}, {543,150}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{504,19}, {504,23}, {503,23}, {503,31}, {512,31}, {512,23}, {507,23}, {507,19}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{521,65}, {521,67}, {513,67}, {513,72}, {526,72}, {526,67}, {523,67}, {523,65}], [{518,76}, {518,77}, {530,77}, {530,76}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{541,88}, {545,88}], [{504,19}, {504,23}, {503,23}, {503,31}, {512,31}, {512,23}, {507,23}, {507,19}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{555,122}, {560,122}], [{521,65}, {521,67}, {513,67}, {513,72}, {526,72}, {526,67}, {523,67}, {523,65}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{532,86}, {536,86}], [{539,150}, {539,152}, {534,152}, {534,159}, {544,159}, {544,152}, {543,152}, {543,150}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{539,150}, {539,152}, {534,152}, {534,159}, {544,159}, {544,152}, {543,152}, {543,150}], [{550,113}, {555,113}], [{554,116}, {559,116}], [{521,65}, {521,67}, {513,67}, {513,72}, {526,72}, {526,67}, {523,67}, {523,65}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{514,60}, {518,60}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{535,84}, {539,84}], [{521,65}, {521,67}, {513,67}, {513,72}, {526,72}, {526,67}, {523,67}, {523,65}], [{511,62}, {515,62}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{529,80}, {533,80}], [{545,131}, {549,131}], [{503,53}, {503,50}, {503,53}, {505,53}, {505,51}, {505,53}, {507,53}, {507,52}, {507,53}, {509,53}, {509,50}, {509,53}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{504,19}, {504,23}, {503,23}, {503,31}, {512,31}, {512,23}, {507,23}, {507,19}], [{539,150}, {539,152}, {534,152}, {534,159}, {544,159}, {544,152}, {543,152}, {543,150}], [{536,172}, {536,168}, {536,172}, {538,172}, {538,164}, {538,172}, {540,172}, {540,168}, {540,172}, {542,172}, {542,163}, {542,172}, {544,172}, {544,164}, {544,172}, {546,172}, {546,171}, {546,172}, {548,172}, {548,165}, {548,172}, {550,172}, {550,170}, {550,172}, {552,172}, {552,170}, {552,172}], [{554,110}, {563,110}], [{539,105}, {539,98}, {539,105}, {541,105}, {541,100}, {541,105}, {543,105}, {543,103}, {543,105}, {545,105}, {545,101}, {545,105}, {547,105}, {547,95}, {547,105}, {549,105}, {549,104}, {549,105}, {551,105}, {551,99}, {551,105}, {553,105}, {553,97}, {553,105}, {555,105}, {555,96}, {555,105}], [{493,15}, {493,16}, {504,16}, {504,15}], [{529,88}, {533,88}], [{527,147}, {527,139}, {527,147}, {529,147}, {529,142}, {529,147}, {531,147}, {531,138}, {531,147}, {533,147}, {533,137}, {533,147}, {535,147}, {535,140}, {535,147}, {537,147}, {537,146}, {537,147}, {539,147}, {539,142}, {539,147}, {541,147}, {541,140}, {541,147}], [{536,134}, {540,134}], [{500,34}, {500,37}, {496,37}, {496,40}, {506,40}, {506,37}, {504,37}, {504,34}], [{520,86}, {524,86}]
    ],


    Map = parse_scan(Input, []),
    {_, Ys} = lists:unzip(Map),
    AbyssLevel = lists:max(Ys) + 1,

    SandSpawner = {500,0},
    % part 1
    Fallen = fall_simulation(SandSpawner, AbyssLevel, Map),
    io:fwrite("~w~n", [length(Fallen) - length(Map)]),
    % part 2
    MapWithFloor = Map ++ lists:zip(lists:seq(1, 1000), lists:duplicate(1000, AbyssLevel + 1)),
    FallenOnFloor = fall_simulation(SandSpawner, 9000, MapWithFloor),
    io:fwrite("~w~n", [length(FallenOnFloor) - length(MapWithFloor)]).


% --- input parser

parse_scan([], Acc) ->
    lists:uniq(Acc);
parse_scan([Blob | Tail], Acc) ->
    parse_scan(Tail, Acc ++ unwind(Blob, [])).

unwind([_], Acc) ->
    Acc;
unwind([A | [B | _] = TailA], Acc) ->
    unwind(TailA, Acc ++ seq(A, B)).

seq({X1, Y1}, {X2, Y2}) when Y1 == Y2, X1 < X2 ->
    lists:zip(lists:seq(X1, X2, +1), lists:duplicate(X2 - X1 + 1, Y1));
seq({X1, Y1}, {X2, Y2}) when Y1 == Y2, X1 > X2 ->
    lists:zip(lists:seq(X1, X2, -1), lists:duplicate(X1 - X2 + 1, Y1));
seq({X1, Y1}, {X2, Y2}) when X1 == X2, Y1 < Y2 ->
    lists:zip(lists:duplicate(Y2 - Y1 + 1, X1), lists:seq(Y1, Y2, +1));
seq({X1, Y1}, {X2, Y2}) when X1 == X2, Y1 > Y2 ->
    lists:zip(lists:duplicate(Y1 - Y2 + 1, X1), lists:seq(Y1, Y2, -1));
seq(_, _) ->
    [].

% --- input parser - END

fall_simulation(Spawner, AbyssLevel, Map) ->
    Finish = fall(Spawner, AbyssLevel, Map),
    case Finish of
        abyss   -> Map;
        Spawner -> [Spawner | Map];
        {_, _}  -> fall_simulation(Spawner, AbyssLevel, [Finish | Map])
    end.

fall({_GX, GY}, AbyssLevel, _Map) when GY == AbyssLevel ->
    abyss;
fall({GX, GY} = Grain, AbyssLevel, Map) ->
    NextOptions = [
        {GX, GY + 1},     % right below
        {GX - 1, GY + 1}, % bottom left
        {GX + 1, GY + 1}  % bottom right
    ],
    NextValidOptions = lists:search(fun({_, X}) ->
        X == false
    end, [ {NO, lists:member(NO, Map) } || NO <- NextOptions ]),
    case NextValidOptions of
        false              -> Grain;
        {value, {Best, _}} -> fall(Best, AbyssLevel, Map)
    end.
